Based on derived-mode-ex.el found here:

<http://cc-mode.sourceforge.net/derived-mode-ex.el>.
